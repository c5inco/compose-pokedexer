# AGENTS.md

This file provides guidance to AI code assistants when working with code in this repository.

## Build Commands

- **Build the project**: `./gradlew build`
- **Run tests**: `./gradlew test`
- **Run instrumentation tests**: `./gradlew connectedAndroidTest`
- **Build debug APK**: `./gradlew assembleDebug`
- **Build release APK**: `./gradlew assembleRelease`
- **Run benchmarks**: `./gradlew :benchmark:pixel4Api31BenchmarkAndroidTest`
- **Clean build**: `./gradlew clean`

## Architecture Overview

This is an Android Pokédex app built with **Jetpack Compose** and following modern Android development patterns:

### Technology Stack
- **UI Framework**: Jetpack Compose with Material 3
- **Architecture**: MVVM with Metro dependency injection
- **Database**: Room (local SQLite database)
- **Network**: Apollo GraphQL client connecting to PokéAPI
- **Navigation**: Compose Navigation
- **Image Loading**: Coil
- **Theming**: Material Kolor for dynamic theming

### Key Components

**Main Entry Points**:
- `MainActivity.kt` - Single activity with edge-to-edge display
- `PokedexerApp.kt` - Main Compose navigation graph, app structure, and Application class
- `PokedexerApplication` - Metro application class with dependency graph initialization

**Data Layer**:
- `PokemonDatabase.kt` - Room database with DAOs for Pokemon, Moves, Items, and Abilities
- Repository pattern with separate repositories for each data type
- GraphQL queries in `app/src/main/graphql/` directory
- Local caching with Room database migrations (currently at version 6)

**UI Structure**:
- `ui/home/` - Main home screen with search functionality
- `ui/pokedex/` - Pokemon list and detail screens
- `ui/moves/` - Moves listing
- `ui/items/` - Items listing
- `ui/common/` - Shared UI components and utilities
- `ui/theme/` - App theming with Material 3

**Dependency Injection**:
- Metro `@DependencyGraph` in `di/ApplicationGraph.kt` for database, network, and repository setup
- `MetroViewModel.kt` provides a `metroViewModel()` composable helper for ViewModel injection in Compose
- ViewModels use Metro's `@Inject` annotation for constructor injection
- Assisted injection with `@Assisted` and `@AssistedFactory` for ViewModels requiring runtime parameters

### Navigation Structure
- Home screen with search and menu navigation
- Nested navigation for Pokédex (list → details)
- Separate routes for Moves and Items
- Custom shared element transitions between screens

### Database Schema
- Pokemon entities with stats, types, evolutions, moves, and abilities
- Type converters for complex data structures (lists, custom objects)
- Auto-migrations handled by Room

### Testing
- Unit tests in `src/test/`
- Instrumentation tests in `src/androidTest/`
- Benchmark tests in separate `benchmark` module
- Database tests for Pokemon and Moves functionality

## Pull Request Guidelines for the Agent
When the agent helps create a PR, please ensure it:

1. Includes a clear description of the changes as guided by AGENTS.md
2. References any related issues that the agent is addressing
3. Ensures all tests pass for code generated by the agent
4. Includes screenshots for UI changes implemented with the agent
5. Keeps PRs focused on a single concern as specified in AGENTS.md